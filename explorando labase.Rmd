---
title: "ANALISIS EXPLORATORIO TIC DE LOS DATOS"
author: "Dario Quishpe"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(readxl)
library(sf)
library(leaflet)
library(deldir)
library(spatstat)
pacman::p_load(tidyverse,sf,mapview)
```

### Estadistica descriptiva de los datos  


```{r}
base<-read.csv("obs_data_112Valencia (1).csv")
base<-base |> filter(year<=2019)
head(base$crime_date)
tail(base$crime_date)
base
#view(base)
```



```{r}
(summary(base))
str(base)

```

```{r}
apply(is.na(base), 2, mean)
```

```{r}
#DIVISIONES DE DISTRTOS ORIGINALES 
#library(sf)
ventana <- st_read("shape files-20221031T083303Z-001/shape files/valencia_outline.shp",quiet=TRUE)
y <- st_read("shape files-20221031T083303Z-001/shape files/valencia_road.shp",quiet=TRUE)

#ggplot()+geom_sf(data = x)+geom_sf(data = y)+geom_sf(data = puntos,aes())+scale_x_continuous()
#y<-st_read("ca_municipios_20231105/ca_municipios_20231105.shp")
#view(x)
#ggplot() + geom_sf(data = x, fill="darkseagreen")
#x <- st_read("drive-download-20231208T164315Z-001/ecuador.shp",quiet=TRUE)
#ventana<-x |> filter(NOMBRE=="VALENCIA")  

#Filtro de base para presentar datos espaciales 
  
puntos_grafica<-puntos |> filter(year>=2015&year<=2019)
dim(puntos_grafica)
dim(puntos)
ggplot()+geom_sf(data = ventana)+geom_sf(data = y)+geom_sf(data = puntos_grafica,aes(),size=0.5,color="#D9DC4C")+scale_x_continuous()
ggplot()+geom_sf(data = ventana)+geom_sf(data = y)+geom_sf(data = puntos_grafica,aes(),size=0.5,color="#D9DC4C")+facet_wrap(~crime_type)+
        theme(axis.text.x = element_text(angle =90, vjust = 0.5, hjust = 1),strip.background = element_rect(fill = "lightblue"))


```
```{r}

#tablita de frecuencias 
tabla<-base |> group_by(crime_type) |> summarise(Tot=n()) |> 
            mutate(Porcentaje=round(Tot/sum(Tot)*100,2))

ggplot(tabla,aes(x=crime_type,y=Tot))+ geom_bar(color="black",fill="#40D6FA",width = 0.9, stat="identity", position = position_dodge())+
             ylim(c(0,75000))+
            labs(x="Tipo de delitos", y= "NÃºmero de delitos") +   
            labs(fill = "")+  
            geom_text(aes(label=paste0(Tot," ", "", "(", Porcentaje, "%",")")),    
            vjust=-0.9, 
            color="black", 
            hjust=0.5,
            position = position_dodge(0.9),  
            angle=0, 
            size=4.0
            ) 

```



